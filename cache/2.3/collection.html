<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="keywords" content="php, cache, database cache, file cache, multiple storages, collections">
<meta name="description" content="Learn how to create and use storage collections">
<title>Storage collection | Opis Cache</title>
        
        <link href="/assets/img/favicon.png" rel="shortcut icon">
        
        
        
<link rel="stylesheet" href="/assets/css/flatly-theme.min.css">

<link href="/assets/css/font-awesome.css" rel="stylesheet">

<link href="/assets/css/syntax.css" rel="stylesheet">



<link href="/assets/css/project.css" rel="stylesheet">


        <!--[if lt IE 9]>
<script src="/assets/js/html5shiv.js"></script>
<script src="/assets/js/respond.min.js"></script>
<![endif]-->
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="/assets/js/jquery-1.11.0.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/assets/js/bootstrap.min.js"></script>


<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
    ga('create', 'UA-50415801-1', 'opis.io');
    ga('send', 'pageview');
</script>

    </head>
    <body>
        
<header id="header" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <img src="/assets/img/opis-gs-100.png" class="img-responsive opis-inline-logo">
            <a href="" class="navbar-brand">
                <strong>
                    Cache
                </strong>
            </a>
            <button data-target="#navbar-main" data-toggle="collapse" type="button" class="navbar-toggle">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>
        <nav id="navbar-main" class="collapse navbar-collapse navbar-right">
            <ul class="nav navbar-nav">
                <li>
                    <a href="/" title="Main page">
                        <span class="fa fa-home"></span> Home
                    </a>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <span class="fa fa-cogs"></span> Components <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="/cache" title="Caching library">Cache</a></li>
                        <li><a href="/closure" title="Serializable closures">Closure</a></li>
                        <li><a href="/config" title="Configuration manager">Config</a></li>
                        <li><a href="/container" title="Dependency injection container">Container</a></li>
                        <li><a href="/database" title="Database abstraction layer">Database</a></li>
                        <li><a href="/events" title="Events library">Events</a></li>
                        <li><a href="https://github.com/opis/http" title="HTTP library">HTTP</a></li>
                        <li><a href="/http-routing" title="HTTP routing library">HTTP Routing</a></li>
                        <li><a href="/routing" title="Routing framework">Routing</a></li>
                        <li><a href="/session" title="Session manager">Session</a></li>
                        <li><a href="/utils" title="Utilitary classes">Utils</a></li>
                        <li><a href="/view" title="Rendering engine">View</a></li>
                    </ul>
                </li>
                
    
    

<li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
        <span class="fa fa-tags"></span> Versions <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
    
        
        <li><a href="/cache">Latest version</a></li>
        
    
        
        
        <li><a href="/cache/2.3">Version 2.3</a></li>
        
    
    </ul>
</li>

                <li>
                    <a href="https://github.com/opis/cache/tree/2.3" title="Github page">
                        <span class="fa fa-github fa-lg"></span> GitHub
                    </a>
                </li>
            </ul>
        </nav>
    </div>
</header>

<section>
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <div class="list-group">
                
                    
                        
<a href="/cache/2.3" class="list-group-item">

    <h4 class="list-group-item-heading">About</h4>
    <p class="list-group-item-text text-muted">
        Getting started with Opis Cache
    </p>
</a>
                    
                
                    
                        
<a href="/cache/2.3/use.html" class="list-group-item">

    <h4 class="list-group-item-heading">Using the library</h4>
    <p class="list-group-item-text text-muted">
        Learn how to use the library
    </p>
</a>
                    
                
                    
                        
<a href="/cache/2.3/collection.html" class="list-group-item active">

    <h4 class="list-group-item-heading">Storage collection</h4>
    <p class="list-group-item-text text-muted">
        Learn how to create and use storage collections
    </p>
</a>
                    
                
                    
                        
<a href="/cache/2.3/storage.html" class="list-group-item">

    <h4 class="list-group-item-heading">Add new storages</h4>
    <p class="list-group-item-text text-muted">
        Learn how you can add support for new storages
    </p>
</a>
                    
                
                </div>
            </div>
            <div class="col-md-8">
                
        


        

<h1>
    
    <strong>Storage collection</strong>
    
</h1>

<p>
    Storage collections allows you to group multiple cache storage implementations into a single collection.
    The collection is fully serializable, allowing you save the state of the collection at any time.
</p>

<p>
    Creating a new collection is simply done by creating a new instance of <code>Opis\Cache\StorageCollection</code> class.
</p>

<div class="highlight"><pre><code class="php"><span class="k">use</span> <span class="nx">Opis\Cache\SorageCollection</span>

<span class="nv">$collection</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">StorageCollection</span><span class="p">();</span>
</code></pre></div>

<p>
    Adding a cache storage implementation to the collection is done by calling the <code>add</code> method.
    The method takes three arguments: a string, representing the name of the implementation, an anonymous function,
    callback and optionally a boolean value that specify if this is the default implementation of this collection (by default is <code>false</code>).
</p>

<p>
    The anonymous callback function must return an instance of <code>Opis\Cache\StorageInterface</code> that
    will be further used to build an <code>Opis\Cache\Cache</code> instance.
</p>

<div class="highlight"><pre><code class="php"><span class="c1">//Adding a new implementation</span>
<span class="nv">$collection</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;memory&#39;</span><span class="p">,</span> <span class="k">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">\Opis\Cache\Storage\Memory</span><span class="p">();</span>
<span class="p">});</span>

<span class="c1">//Adding another implementation and set it as the default cache implementation</span>
<span class="nv">$collection</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="k">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">\Opis\Cache\Storage\File</span><span class="p">(</span><span class="s1">&#39;/path/to/cache/folder&#39;</span><span class="p">);</span>
<span class="p">},</span> <span class="k">true</span><span class="p">);</span>
</code></pre></div>


<p>
    Retrieving an implementation is done bay calling the <code>get</code> method with a string argument
    representing the name of the implementation. If the argument is omitted, then the default implementation
    will be returned. If no implementation was explicitly designated as the default implementation,
    then the first implementation added to the collection will be designated as the default implementation
    for this collection.
</p>

<div class="highlight"><pre><code class="php"><span class="c1">//Write to memory cache</span>
<span class="nv">$collection</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;memory&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello world&#39;</span><span class="p">);</span>

<span class="c1">//Write to the default (file) cache</span>
<span class="nv">$collection</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello world&#39;</span><span class="p">);</span>
</code></pre></div>

<p>
    Checking if an implementation exist, is done by using the <code>has</code> method.
</p>
<div class="highlight"><pre><code class="php"><span class="k">if</span><span class="p">(</span><span class="nv">$collection</span><span class="o">-&gt;</span><span class="na">has</span><span class="p">(</span><span class="s1">&#39;memory&#39;</span><span class="p">))</span>
<span class="p">{</span>
    <span class="nv">$collection</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;memory&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello World!&#39;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>
    Changing or setting the default implementation is done by calling the <code>setDefault</code> method
    and passing as an argument to the method a string representing the implementation name.
</p>

<div class="highlight"><pre><code class="php"><span class="nv">$collection</span><span class="o">-&gt;</span><span class="na">setDefault</span><span class="p">(</span><span class="s1">&#39;memory&#39;</span><span class="p">);</span>
</code></pre></div>

<p>
    Removing an implementation is done by calling the <code>remove</code> method and passing as an argument
    a string representing the implementation name.
</p>

<div class="highlight"><pre><code class="php"><span class="nv">$collection</span><span class="o">-&gt;</span><span class="na">remove</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">);</span>
</code></pre></div>


                





    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
        
    

    
        
            
                
                
            
        
    


<ul class="pager">
  
  <li class="previous"><a href="/cache/2.3/use.html" title="Using the library">&larr; Back</a></li>
  
  
  <li class="next"><a href="/cache/2.3/storage.html" title="Add new storages">Next &rarr;</a></li>
  
</ul>
                
            </div>
        </div>
    </div>
</section>

<footer class="text-center text-muted">
    Copyright &copy; 2014-2015 Marius Sarca. All rights reserved.
</footer>

    </body>
</html>
