---
layout: database
title: Joins | Opis Database
keywords: php, database, abstraction, query builder, schema builder
description: Learn how to perform joins
active: join
---
<h1><strong>Joins</strong></h1>

<p>
    Joins are used to combine rows from two or more tables, based on a common field between them.
    <strong>Opis Database</strong> allows you to perform four type of joins:
    <strong>INNER</strong> join by using the <code>join</code> method,
    <strong>LEFT</strong> join by using the <code>leftJoin</code> method,
    <strong>RIGHT</strong> join by using the <code>rightJoin</code> method
    and <strong>FULL</strong> join by using the <code>fullJoin</code> method.
</p>

<p>
    Performing a join is done in a similar manner for all four types of joins.
    All join methods accepts two arguments: the first argument represents the joined table
    and the second argument must be an anonymous callback function, which will receive as an
    argument an object that will be further used to set the join's conditions to be met.
</p>

<p>
    Adding a join condition is done by using the <code>on</code> method. This methods accepts two arguments,
    representing the two columns on which the join will be performed,
    and optionally a third argument representing the comparison operator which can be one of the following:
    <code>=</code>, <code>!=</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code> and <code>&lt;=</code>.
    If no comparison operator is specified, the <code>=</code> operator will be used by default.
</p>

{% highlight php startinline %}
$result = $db->from('users')
             ->join('profiles', function($join){
                $join->on('users.id', 'profiles.id');
             })
             ->select()
             ->all();
{% endhighlight %}
{% highlight sql %}
SELECT * FROM `users` INNER JOIN `profiles` ON `users`.`id` = `profiles`.`id`
{% endhighlight %}

<p>
    Adding multiple join conditions is done by using the <code>andOn</code> and <code>orOn</code> method.
    Depending on which method you use, the join condition will be combined with the previous declared join
    condition using the <code>AND</code> or the <code>OR</code> operator.
</p>

<p>
    To add an additional condition to your join expression,
    that combines with the previous declared condition by using an <code>AND</code> operator, use the <code>andOn</code> method. 
</p>

{% highlight php startinline %}
$result = $db->from('users')
             ->join('profiles', function($join){
                $join->on('users.id', 'profiles.id')
                     ->andOn('users.email', 'profile.primary_email');
             })
             ->select()
             ->all();
{% endhighlight %}
{% highlight sql %}
SELECT * FROM `users`
    INNER JOIN `profiles`
        ON `users`.`id` = `profiles`.`id`
        AND `users`.`email` = `profile`.`primary_email`
{% endhighlight %}

<p>
    To add an additional condition to your join expression,
    that combines with the previous declared condition by using an <code>OR</code> operator, use the <code>orOn</code> method. 
</p>

{% highlight php startinline %}
$result = $db->from('users')
             ->join('profiles', function($join){
                $join->on('users.id', 'profiles.id')
                     ->orOn('users.email', 'profile.primary_email');
             })
             ->select()
             ->all();
{% endhighlight %}
{% highlight sql %}
SELECT * FROM `users`
    INNER JOIN `profiles`
        ON `users`.`id` = `profiles`.`id`
        OR `users`.`email` = `profile`.`primary_email`
{% endhighlight %}

<p>
    You can also group your join conditions, by passing as an argument to the <code>on</code>,
    <code>andOn</code> and <code>orOn</code> methods, an anonymous callback function.
</p>

{% highlight php startinline %}
$result = $db->from('users')
             ->join('profiles', function($join){
                $join->on('users.id', 'profiles.id')
                     ->andOn(function($join){
                        $join->on('users.email', 'profiles.primary_email')
                             ->orOn('users.email', 'profiles.secondary_email');
                     });
             })
             ->select()
             ->all();
{% endhighlight %}
{% highlight sql %}
SELECT * FROM `users`
    INNER JOIN `profiles`
        ON `users`.`id` = `profiles`.`id`
        AND (`users`.`email` = `profiles`.`primary_email`
                OR
             `users`.`email` = `profiles`.`secondary_email`)
{% endhighlight %}

<p>
    Aliasing the table name used within a join, is done by passing a <code>key => value</code>
    mapped array to the used join method, where the <code>key</code> represents the table's name and
    the <code>value</code> represents the alias name.
</p>

{% highlight php startinline %}
$result = $db->from('users')
             ->join(array('profiles' => 'p'), function($join){
                $join->on('users.id', 'p.id');
             })
             ->select()
             ->all();
{% endhighlight %}
{% highlight sql %}
SELECT * FROM `users` INNER JOIN `profiles` AS `p` ON `users`.`id` = `p`.`id`
{% endhighlight %}
