<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="keywords" content="php, database, abstraction, query builder, schema builder, orm, obejct relational mapping">
<meta name="description" content="Learn about the relationship between models">
<title>Relationships | Opis Database</title>
        
        <link href="/assets/img/favicon.png" rel="shortcut icon">
        
        
        
<link rel="stylesheet" href="/assets/css/flatly-theme.min.css">

<link href="/assets/css/font-awesome.css" rel="stylesheet">

<link href="/assets/css/syntax.css" rel="stylesheet">



<link href="/assets/css/project.css" rel="stylesheet">


        
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.1.1/gh-fork-ribbon.min.css" />
        <!--[if lt IE 9]>
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.1.1/gh-fork-ribbon.ie.min.css" />
        <![endif]--> 
        
        <!--[if lt IE 9]>
<script src="/assets/js/html5shiv.js"></script>
<script src="/assets/js/respond.min.js"></script>
<![endif]-->
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="/assets/js/jquery-1.11.0.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/assets/js/bootstrap.min.js"></script>


<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
    ga('create', 'UA-50415801-1', 'opis.io');
    ga('send', 'pageview');
</script>

    </head>
    <body>
        

<div class="github-fork-ribbon-wrapper right hidden-sm hidden-xs">
    <div class="github-fork-ribbon" style="background-color: #f80">
        <a href="https://github.com/opis/database">Fork me on GitHub</a>
    </div>
</div>

<header id="header" class="navbar navbar-default navbar-static-top">
    <div class="container">
        <div class="navbar-header">
            <img src="/assets/img/opis-gs-100.png" class="img-responsive opis-inline-logo">
            <a href="/database" class="navbar-brand">
                <strong>
                    Database
                </strong>
            </a>
            <button data-target="#navbar-main" data-toggle="collapse" type="button" class="navbar-toggle">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>
        <nav id="navbar-main" class="collapse navbar-collapse navbar-right">
            <ul class="nav navbar-nav">
                <li>
                    <a href="/" title="Main page">
                        <span class="fa fa-home"></span> Home
                    </a>
                </li>
                <li class="dropdown hidden-md hidden-lg">
    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
        <span class="fa fa-file-text"></span> Documentation <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
    
        
        <li class="dropdown-header">Getting started</li>
        
        <li><a href="/database" title="Getting started with Opis Database">About</a></li>
    
        
        <li><a href="/database/connection.html" title="Learn how to connect to a database">Database connections</a></li>
    
        
        <li class="dropdown-header">The basics</li>
        
        <li><a href="/database/select.html" title="Fetching records from a database">Fetching records</a></li>
    
        
        <li><a href="/database/result.html" title="Learn how to handle the result set of a query">Results handling</a></li>
    
        
        <li><a href="/database/aggregate.html" title="Learn about aggregate functions">Aggregate functions</a></li>
    
        
        <li><a href="/database/extended-selections.html" title="Learn about how to define custom selections">Extended selections</a></li>
    
        
        <li><a href="/database/filter.html" title="Learn how to filter records">Filters</a></li>
    
        
        <li><a href="/database/expression.html" title="Learn about expressions">Expressions</a></li>
    
        
        <li><a href="/database/order.html" title="Learn how to order results">Ordering criteria</a></li>
    
        
        <li><a href="/database/limit.html" title="Learn about limits and offsets">Limits and offsets</a></li>
    
        
        <li><a href="/database/join.html" title="Learn how to perform joins">Joins</a></li>
    
        
        <li><a href="/database/aggregates-handling.html" title="Learn how to work with aggregates">Working with aggregates</a></li>
    
        
        <li><a href="/database/insert.html" title="Insert new records into a table">Create records</a></li>
    
        
        <li><a href="/database/update.html" title="Learn how to update existing records">Update records</a></li>
    
        
        <li><a href="/database/delete.html" title="Learn how to delete existing records">Delete records</a></li>
    
        
        <li class="dropdown-header">Transactions</li>
        
        <li><a href="/database/transaction.html" title="Learn how to use transactions">Performing transactions</a></li>
    
        
        <li class="dropdown-header">Database schema</li>
        
        <li><a href="/database/schema.html" title="Learn about Opis Database schema">Introduction</a></li>
    
        
        <li><a href="/database/creating-tables.html" title="Creating new tables">Creating tables</a></li>
    
        
        <li><a href="/database/modifying-tables.html" title="Modify existing tables">Modifying tables</a></li>
    
        
        <li class="dropdown-header">ORM</li>
        
        <li><a href="/database/orm.html" title="Learn about Opis Database ORM">Introduction</a></li>
    
        
        <li><a href="/database/orm-basics.html" title="Learn about ORM relationships">Basic operations</a></li>
    
        
        <li class="active"><a href="/database/orm-relationships.html" title="Learn about ORM relationships">Relationships</a></li>
    
        
        <li><a href="/database/orm-models.html" title="Learn about ORM relationships">Working with models</a></li>
    
    </ul>
</li>
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <span class="fa fa-cogs"></span> Components <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="/cache" title="Caching library">Cache</a></li>
                        <li><a href="/closure" title="Serializable closures">Closure</a></li>
                        <li><a href="/config" title="Configuration manager">Config</a></li>
                        <li><a href="/container" title="Dependency injection container">Container</a></li>
                        <li><a href="/database" title="Database abstraction layer">Database</a></li>
                        <li><a href="/events" title="Events library">Events</a></li>
                        <li><a href="/http" title="HTTP library">HTTP</a></li>
                        <li><a href="/http-routing" title="HTTP routing library">HTTP Routing</a></li>
                        <li><a href="/routing" title="Routing framework">Routing</a></li>
                        <li><a href="/session" title="Session manager">Session</a></li>
                        <li><a href="/utils" title="Utilitary classes">Utils</a></li>
                        <li><a href="/view" title="Rendering engine">View</a></li>
                    </ul>
                </li>
                
    
    

                <li class="hidden-md hidden-lg">
                    <a href="https://github.com/opis/database" title="Github page">
                        <span class="fa fa-github fa-lg"></span> GitHub
                    </a>
                </li>
            </ul>
        </nav>
    </div>
</header>

<section>
    <div class="container">
        <div class="row">
            <div class="col-md-4 hidden-xs hidden-sm">
                
                    
<ul class="navigation">

    
        
            
        
        <li class="chapter">Getting started</li>
        <ul>
            <li><a href="/database" title="Getting started with Opis Database">About</a></li>
    

    
        <li><a href="/database/connection.html" title="Learn how to connect to a database">Database connections</a></li>
    

    
        
        </ul>
        
        <li class="chapter">The basics</li>
        <ul>
            <li><a href="/database/select.html" title="Fetching records from a database">Fetching records</a></li>
    

    
        <li><a href="/database/result.html" title="Learn how to handle the result set of a query">Results handling</a></li>
    

    
        <li><a href="/database/aggregate.html" title="Learn about aggregate functions">Aggregate functions</a></li>
    

    
        <li><a href="/database/extended-selections.html" title="Learn about how to define custom selections">Extended selections</a></li>
    

    
        <li><a href="/database/filter.html" title="Learn how to filter records">Filters</a></li>
    

    
        <li><a href="/database/expression.html" title="Learn about expressions">Expressions</a></li>
    

    
        <li><a href="/database/order.html" title="Learn how to order results">Ordering criteria</a></li>
    

    
        <li><a href="/database/limit.html" title="Learn about limits and offsets">Limits and offsets</a></li>
    

    
        <li><a href="/database/join.html" title="Learn how to perform joins">Joins</a></li>
    

    
        <li><a href="/database/aggregates-handling.html" title="Learn how to work with aggregates">Working with aggregates</a></li>
    

    
        <li><a href="/database/insert.html" title="Insert new records into a table">Create records</a></li>
    

    
        <li><a href="/database/update.html" title="Learn how to update existing records">Update records</a></li>
    

    
        <li><a href="/database/delete.html" title="Learn how to delete existing records">Delete records</a></li>
    

    
        
        </ul>
        
        <li class="chapter">Transactions</li>
        <ul>
            <li><a href="/database/transaction.html" title="Learn how to use transactions">Performing transactions</a></li>
    

    
        
        </ul>
        
        <li class="chapter">Database schema</li>
        <ul>
            <li><a href="/database/schema.html" title="Learn about Opis Database schema">Introduction</a></li>
    

    
        <li><a href="/database/creating-tables.html" title="Creating new tables">Creating tables</a></li>
    

    
        <li><a href="/database/modifying-tables.html" title="Modify existing tables">Modifying tables</a></li>
    

    
        
        </ul>
        
        <li class="chapter">ORM</li>
        <ul>
            <li><a href="/database/orm.html" title="Learn about Opis Database ORM">Introduction</a></li>
    

    
        <li><a href="/database/orm-basics.html" title="Learn about ORM relationships">Basic operations</a></li>
    

    
        <li class="active"><a href="/database/orm-relationships.html" title="Learn about ORM relationships">Relationships</a></li>
    

    
        <li><a href="/database/orm-models.html" title="Learn about ORM relationships">Working with models</a></li>
    

    </ul>
</ul>

                
            </div>
            <div class="col-md-8 col-sm-12">
                
        


        

<h1>
    
    <strong>Relationships</strong>
    
</h1>

<ol class="submenu">
    <li>




    

<a href="#introduction">Introduction</a></li>
    <li>




    

<a href="#one-to-one">One to one</a></li>
    <li>




    

<a href="#one-to-many">One to many</a></li>
    <li>




    

<a href="#many-to-many">Many to many</a></li>
</ol>


        


    


        


    

<h3>
    
    
    <strong>Introduction</strong>
    
    <a id="introduction" href="#introduction" class="link-anchor"><span class="fa fa-link"></span></a>
</h3>

<p>    
    The relationships between tables can be described by adding methods to your model class and utilize the
    <code>hasOne</code>, <code>hasMany</code>, <code>belongsTo</code> and <code>belongsToMany</code>, 
    inside those methods, to define the type of the relationship between two models.
</p>

<p>
    The related models can be then retrieved from a model instance by getting the value of the property that
    has the same name as the relationship method. 
</p>

<div class="highlight"><pre><code class="php"><span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseModel</span>
<span class="p">{</span>
    <span class="c1">// Define a relationship </span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">articles</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasMany</span><span class="p">(</span><span class="s1">&#39;Article&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ...</span>

<span class="nv">$user</span> <span class="o">=</span> <span class="nx">User</span><span class="o">::</span><span class="na">find</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Get the related models</span>
<span class="k">foreach</span><span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">articles</span> <span class="k">as</span> <span class="nv">$article</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$article</span><span class="o">-&gt;</span><span class="na">title</span><span class="p">,</span> <span class="nx">PHP_EOL</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>


        


    


        


    

<h3>
    
    
    <strong>One to one</strong>
    
    <a id="one-to-one" href="#one-to-one" class="link-anchor"><span class="fa fa-link"></span></a>
</h3>

<p>
    A one-to-one relationship is a relation where each record of a table has a single related record into another table.
    For example a <code>User</code> might be associated with a <code>Profile</code>. Defining the relationship
    between <code>User</code> and <code>Profile</code> can be done by placing a <code>profile</code> method
    on the <code>User</code> model. The <code>profile</code> method must return the result of calling the
    <code>hasOne</code> method.
</p>

<div class="highlight"><pre><code class="php"><span class="k">class</span> <span class="nc">Profile</span> <span class="k">extends</span> <span class="nx">BaseModel</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseModel</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">profile</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasOne</span><span class="p">(</span><span class="s1">&#39;Profile&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ...</span>

<span class="nv">$user</span> <span class="o">=</span> <span class="nx">User</span><span class="o">::</span><span class="na">find</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="k">echo</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">profile</span><span class="o">-&gt;</span><span class="na">description</span><span class="p">;</span>
</code></pre></div>

<p>
    The first argument passed to the <code>hasOne</code> method must be the class name of the related model. If
    the model class is under a namespace, then the namespace must be included as well.
</p>

<div class="highlight"><pre><code class="php"><span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasOne</span><span class="p">(</span><span class="s1">&#39;\My\Namespace\Profile&#39;</span><span class="p">);</span>
</code></pre></div>

<p>
    Opis Database ORM assumes that the foreign key of the relationship is based on the related model's name.
    In this particular case, the <code>Profile</code> model is assumed to have a <code>user_id</code> foreign
    key. If the related model has a differently named foreign key, you can specify this by passing
    the foreign key's name as a second argument to the <code>hasOne</code> method.
</p>

<div class="highlight"><pre><code class="php"><span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasOne</span><span class="p">(</span><span class="s1">&#39;Profile&#39;</span><span class="p">,</span> <span class="s1">&#39;foreign_key&#39;</span><span class="p">);</span>
</code></pre></div>


    


    


        


    

<h4>
    
    
    <strong>The inverse of the relation</strong>
    
    <a id="has-one-the-inverse-of-the-relation" href="#has-one-the-inverse-of-the-relation" class="link-anchor"><span class="fa fa-link"></span></a>
</h4>

<p>
    Defining the inverse of a one-to-one relationship is done by using the <code>belongsTo</code> method.
</p>

<div class="highlight"><pre><code class="php"><span class="k">class</span> <span class="nc">Profile</span> <span class="k">extends</span> <span class="nx">BaseModel</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">user</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsTo</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseModel</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">profile</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasOne</span><span class="p">(</span><span class="s1">&#39;Profile&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ...</span>

<span class="nv">$profile</span> <span class="o">=</span> <span class="nx">Profile</span><span class="o">::</span><span class="na">find</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="k">echo</span> <span class="nv">$profile</span><span class="o">-&gt;</span><span class="na">user</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">;</span>
</code></pre></div>

<p>
    The first argument passed to the <code>belongsTo</code> method must be the class name of the parent model. If
    the model class is under a namespace, then the namespace must be included as well.
</p>

<div class="highlight"><pre><code class="php"><span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsTo</span><span class="p">(</span><span class="s1">&#39;\My\Namespace\User&#39;</span><span class="p">);</span>
</code></pre></div>

<p>
    If the model foreign key's name  is different from the name assumed
    by Opis Database(parent table name + <code>_id</code> suffix), than you can specify
    the foreign key's name by passing it as the second argument to the <code>belongsTo</code>
    method.
</p>

<div class="highlight"><pre><code class="php"><span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsTo</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">,</span> <span class="s1">&#39;foreign_key&#39;</span><span class="p">);</span>
</code></pre></div>


        


    


        


    

<h3>
    
    
    <strong>One to many</strong>
    
    <a id="one-to-many" href="#one-to-many" class="link-anchor"><span class="fa fa-link"></span></a>
</h3>

<p>
    A one-to-many relationship is a relation where each record of a table might have multiple
    related records into another table. For example, a <code>User</code> might be associated
    with multiple <code>Article</code>s. Defining the relationship between <code>User</code>
    and <code>Article</code> can be done by placing an <code>articles</code> method
    on the <code>User</code> model. The <code>articles</code> method must return the result of
    calling the <code>hasMany</code> method.
</p>

<div class="highlight"><pre><code class="php"><span class="k">class</span> <span class="nc">Article</span> <span class="k">extends</span> <span class="nx">BaseModel</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseModel</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">articles</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasMany</span><span class="p">(</span><span class="s1">&#39;Article&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ...</span>

<span class="nv">$user</span> <span class="o">=</span> <span class="nx">User</span><span class="o">::</span><span class="na">find</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="k">foreach</span><span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">articles</span> <span class="k">as</span> <span class="nv">$article</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$article</span><span class="o">-&gt;</span><span class="na">title</span><span class="p">,</span> <span class="nx">PHP_EOL</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>
    The first argument passed to the <code>hasMany</code> method must be the class name of the related model. If
    the model class is under a namespace, then the namespace must be included as well.
</p>

<div class="highlight"><pre><code class="php"><span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasMany</span><span class="p">(</span><span class="s1">&#39;\My\Namespace\Article&#39;</span><span class="p">);</span>
</code></pre></div>

<p>
    If the related model's foreign key doesn't follow the Opis Databse naming convention(parent table name +
    <code>_id</code> suffix), you may specify the foreign key's name by passing it as the second argument
    to the <code>hasMany</code> method.
</p>

<div class="highlight"><pre><code class="php"><span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasMany</span><span class="p">(</span><span class="s1">&#39;Article&#39;</span><span class="p">,</span> <span class="s1">&#39;foreign_key&#39;</span><span class="p">);</span>
</code></pre></div>


    


    


        


    

<h4>
    
    
    <strong>The inverse of the relation</strong>
    
    <a id="has-many-the-inverse-of-the-relation" href="#has-many-the-inverse-of-the-relation" class="link-anchor"><span class="fa fa-link"></span></a>
</h4>

<p>
    As in the case of the one-to-one relationships, the inverse of a one-to-many relationship
    can be defined by using the <code>belongsTo</code> method.
</p>

<div class="highlight"><pre><code class="php"><span class="k">class</span> <span class="nc">Article</span> <span class="k">extends</span> <span class="nx">BaseModel</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">author</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsTo</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseModel</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">articles</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasMany</span><span class="p">(</span><span class="s1">&#39;Article&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ...</span>

<span class="nv">$article</span> <span class="o">=</span> <span class="nx">Article</span><span class="o">::</span><span class="na">find</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="k">echo</span> <span class="nv">$article</span><span class="o">-&gt;</span><span class="na">author</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">;</span>
</code></pre></div>


        


    


        


    

<h3>
    
    
    <strong>Many to many</strong>
    
    <a id="many-to-many" href="#many-to-many" class="link-anchor"><span class="fa fa-link"></span></a>
</h3>

<p>
    A many-to-many relationship is a relation where a record from a table might share
    with other records from the same table, multiple related records that are stored
    into another table. 
</p>

<p>
    An example of such a relationship is a user with many roles whom also might
    be shared by other users. In order to define such a relationship, there must be a
    <a href="http://en.wikipedia.org/wiki/Junction_table">junction table</a>
    between the two related tables. 
</p>

<p>
    Defining a many-to-many relationship is done by using the <code>belongsToMany</code>
    method. The method takes as an argument the full class name(including the namespace) of
    the related model.
</p>

<div class="highlight"><pre><code class="php"><span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseModel</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">roles</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsToMany</span><span class="p">(</span><span class="s1">&#39;Role&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Role</span> <span class="k">extends</span> <span class="nx">BaseModel</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">users</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsToMany</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ...</span>

<span class="nv">$user</span> <span class="o">=</span> <span class="nx">User</span><span class="o">::</span><span class="na">find</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="k">foreach</span><span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">roles</span> <span class="k">as</span> <span class="nv">$role</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$role</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">,</span> <span class="nx">PHP_EOL</span><span class="o">:</span>
<span class="p">}</span>

<span class="nv">$role</span> <span class="o">=</span> <span class="nx">Role</span><span class="o">::</span><span class="na">find</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="k">foreach</span><span class="p">(</span><span class="nv">$role</span><span class="o">-&gt;</span><span class="na">users</span> <span class="k">as</span> <span class="nv">$user</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">,</span> <span class="nx">PHP_EOL</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>


    


    


        


    

<h4>
    
    
    <strong>Naming conventions</strong>
    
    <a id="naming-conventions" href="#naming-conventions" class="link-anchor"><span class="fa fa-link"></span></a>
</h4>

<p>
    The junction table name is assumed to be formed from the names of the related
    tables taken in alphabetical order and separated by an underscore. So, if we have
    two related tables named <code>foo</code> and <code>bar</code>, the junction table
    will be <code>bar_foo</code>.
    If the name of your junction table doesn't follow this naming convention, then you must
    pass the name of your junction table as the third argument to the <code>belongsToMany</code>
    method.
</p>

<div class="highlight"><pre><code class="php"><span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsToMany</span><span class="p">(</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="s1">&#39;junction_table&#39;</span><span class="p">);</span>
</code></pre></div>

<p>
    The junction table must define two columns containing foreign keys to the related tables.
    If we have to related tables <code>foo</code> and <code>bar</code>, the column names must be
    <code>foo_id</code> and <code>bar_id</code>.
</p>

<p>
    If the foreign key that points from the junction table back to the model doesn't follow the
    naming convention, you must pass the name of the foreign key as the second argument to the
    <code>belongsToMany</code> method.
</p>

<div class="highlight"><pre><code class="php"><span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsToMany</span><span class="p">(</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span> <span class="s1">&#39;fk_user&#39;</span><span class="p">);</span>
</code></pre></div>

<p>
    If the foreign key that points from the junction table to the related model doesn't follow the
    naming convention, you must pass the name of the foreign key as the fourth argument to the
    <code>belongsToMany</code> method.
</p>

<div class="highlight"><pre><code class="php"><span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsToMany</span><span class="p">(</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="s1">&#39;fk_role&#39;</span><span class="p">);</span>
</code></pre></div>


                





    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
                
            
        
    

    
        
            
        
    

    
        
            
                
                
            
        
    


<ul class="pager">
  
  <li class="previous"><a href="/database/orm-basics.html" title="Basic operations">&larr; Back</a></li>
  
  
  <li class="next"><a href="/database/orm-models.html" title="Working with models">Next &rarr;</a></li>
  
</ul>
                
            </div>
        </div>
    </div>
</section>
<a href="#0" id="back-to-top">
    <span class="fa fa-arrow-up"></span>
</a>
<script>
    (function($){
        
        $(document).ready(function(){
           var visible = false;
           $(window).scroll(function(){
                var top = $(this).scrollTop();
                
                if (top >= 100 && !visible) {
                   visible = true;
                   $('#back-to-top').fadeIn().show();
                 }
                 if(top < 100 && visible){
                   visible = false;
                   $('#back-to-top').fadeOut();  
                 }
           });
           
            $('#back-to-top').click(function(){
                $('html, body').animate({scrollTop : 0},800);
                return false;
            });
            
        });
        
        
    })(jQuery);
</script>
<footer class="text-center text-muted">
    Copyright &copy; 2014-2015 Marius Sarca. All rights reserved.
</footer>

    </body>
</html>
